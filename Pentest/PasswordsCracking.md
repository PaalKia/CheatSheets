# John The Ripper 

### Introduction

John the Ripper (john / JtR) est un outil open-source de référence pour le *password cracking* (brute-force, dictionnaire, etc.), avec de nombreux modes d’attaque et un support étendu de formats de hash.  
**Astuce** : Utiliser la version “jumbo” pour profiter de toutes les fonctionnalités.

## Modes d’attaque

### Single Crack Mode

**Utilise les infos du compte utilisateur (login, répertoire, GECOS) pour générer des mots de passe candidats.**
```bash
john --single <fichier_hash>
```
Exemple : Crack rapide basé sur les infos de l’utilisateur Linux (utile sur /etc/passwd ou /etc/shadow).

### Wordlist Mode (mode dictionnaire)

**Teste chaque mot d’un wordlist comme mot de passe candidat (attaque par dictionnaire).**
```bash
john --wordlist=<wordlist_file> <hash_file>
```
Possibilité d’ajouter `--rules` pour transformer les mots (capitalisation, ajouts de chiffres…).

### Incremental Mode (mode incrémental)

**Brute-force avancé basé sur des statistiques de mots de passe réels (Markov chain).**
```bash
john --incremental <hash_file>
```
Le plus exhaustif (et lent) : essaye toutes les combinaisons de caractères selon un charset défini.


## Identifier un format de hash

**Utilise hashid pour deviner le type de hash et obtenir la syntaxe John correspondante.**
```bash
hashid -j <hash>
```
Affiche tous les formats potentiels et la syntaxe --format=xxx à utiliser avec john.

### Spécifier le format de hash dans John

**Forcer le format de hash à utiliser si John ne détecte pas automatiquement.**
```bash
john --format=<format_john> <hash_file>
```

## Cracker des fichiers protégés (PDF, ZIP, RAR, etc.)

**Convertir un fichier en hash compatible John avec les outils *2john, puis cracker avec John.**
```bash
<tool> <fichier> > fichier.hash
john fichier.hash
```
Exemples d’outils :
- pdf2john, zip2john, rar2john, office2john, keepass2john, ssh2john, gpg2john, etc.

## Afficher les mots de passe crackés

**Afficher les résultats déjà trouvés par John.**
```bash
john --show <hash_file>
```
## Ressources complémentaires

- [Doc](https://github.com/openwall/john/tree/bleeding-jumbo/doc) (Openwall)
- [PentestMonkey hash formats](https://pentestmonkey.net/cheat-sheet/john-the-ripper-hash-formats)

# Hashcat

## Présentation

Hashcat est un puissant outil de *password cracking* multi-plateforme (Linux, Windows, macOS) optimisé GPU, supportant de nombreux formats de hash et modes d’attaque.  
Chaque mode ou format s’utilise via des options dédiées.


## Syntaxe Générale
```bash
hashcat -a <mode> -m <id_hash> <hashes> [wordlist, rule, mask, ...]
```

- `-a` : mode d’attaque (0 = dictionnaire, 3 = mask, etc.)
- `-m` : identifiant du type de hash (ex : 0 pour MD5, 1000 pour NTLM)
- `<hashes>` : fichier ou hash(s) à casser
- `[wordlist, rule, mask, ...]` : dépend du mode utilisé

## Identifier le type de hash

Lister tous les modes/ID supportés :
```bash
hashcat --help
```

## Dictionnaire (Dictionary Attack, -a 0)

Teste chaque mot du wordlist comme mot de passe candidat.
```bash
hashcat -a 0 -m <id_hash> <hash> <wordlist>
```

## Dictionnaire + Règles

Applique des transformations aux mots du wordlist pour générer plus de candidats.
```bash
hashcat -a 0 -m <id_hash> <hash> <wordlist> -r <fichier_regle>
```

Lister les règles disponibles :
```bash
ls /usr/share/hashcat/rules/
```

## Mask Attack (attaque par masque, -a 3)

Brute-force ciblé : définit le pattern de mot de passe à tester avec des masques.
```bash
hashcat -a 3 -m <id_hash> <hash> <mask>
```

**Symboles de masque principaux :**
- ?l : lettre minuscule
- ?u : lettre majuscule
- ?d : chiffre
- ?s : symbole spécial
- ?a : tous caractères imprimables

## Exemples d'options utiles

- Voir l’avancement :
```bash
hashcat --status
```

- Forcer l’utilisation CPU (au lieu de GPU) :
```bash
hashcat -D 1 ...
```
- Reprendre une session :
```bash
hashcat --restore
```

## Ressources utiles

- [Liste complète des hash modes Hashcat](https://hashcat.net/wiki/doku.php?id=example_hashes)
- [Hashcat rules documentation](https://hashcat.net/wiki/doku.php?id=rule_based_attack)


---

# Cracking Protected Files

## Trouver des fichiers chiffrés / protégés

Rechercher les fichiers à extensions courantes (Office, PDF, etc.) sur un système Linux :
```bash
for ext in $(echo ".xls .xls* .xltx .od* .doc .doc* .pdf .pot .pot* .pp*"); do
echo -e "\nFile extension: $ext"
find / -name *$ext 2>/dev/null | grep -v "lib|fonts|share|core"
done
```
*Cherche sur tout le disque les fichiers de type document potentiellement chiffrés/protégés.*

## Trouver des clés SSH privées

Chercher des clés SSH privées par leur entête (HEADER) :
```bash
grep -rnE '^-{5}BEGIN [A-Z0-9]+ PRIVATE KEY-{5}$' /* 2>/dev/null
```
*Repère tous les fichiers contenant une clé privée (RSA, ED25519, etc.).*

## Vérifier si une clé SSH est chiffrée

Lire la clé pour voir si elle demande une passphrase :
```bash
ssh-keygen -yf ~/.ssh/id_rsa
```

*Si elle est protégée, un prompt passphrase apparaît. Sinon, la clé publique s’affiche.*

## Extraire un hash depuis un fichier protégé (avec *2john)

Extraire le hash :
```bash
ssh2john.py SSH.private > ssh.hash
```

Cracker avec John :
```bash
john --wordlist=rockyou.txt ssh.hash
```

Afficher les résultats :
```bash
john ssh.hash --show
```

### Exemple : Cracker un document Office

Extraire le hash :
```bash
office2john.py Protected.docx > protected-docx.hash
```

Cracker : 
```bash
john --wordlist=rockyou.txt protected-docx.hash
```

### Exemple : Cracker un PDF protégé

Extraire le hash :
```bash
pdf2john.py PDF.pdf > pdf.hash
```

Cracker : 
```bash
john --wordlist=rockyou.txt pdf.hash
```











































